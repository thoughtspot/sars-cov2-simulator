{"version":3,"sources":["components/slider/slider.tsx","components/controls/controls-data.ts","data-store.ts","components/region-select/region-select.tsx","components/controls/controls.tsx","components/shudown-range/shutdown-range.tsx","services/viewport-service.ts","components/chart/chart.tsx","components/table/table.tsx","components/simulator/use-generate-config.ts","components/simulator/data-generator.ts","components/simulator/optimal-weeks-generator.ts","components/simulator/simulator.tsx","components/headline/headline.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["useStyles","makeStyles","slider","width","Slider","title","onChange","percent","tooltip","props","classes","getValue","value","undefined","Grid","container","direction","alignItems","spacing","Tooltip","placement","item","Typography","min","className","aria-labelledby","valueLabelDisplay","valueLabelFormat","onChangeCommitted","event","name","max","id","variant","sliders","step","defaultValue","USStateInfectedData","Map","countryInfectedData","USStateData","countryData","timeLineData","stateCodeMap","countryNameApiMapping","countryCodeMapping","countryStateData","unsortedCountryStateData","sort","v1","v2","country","useInitCovidData","React","useState","loaded","setLoaded","forEach","state","set","population","hospitalBeds","icuBeds","stateCodeMapping","Code","State","countryApiMapping","Country_Name","Api_Mapping","Promise","all","initStateCovidData","initCountryCovidData","getCountrySpecificData","then","console","log","catch","error","getCovidData","placeName","newPlaceName","has","get","countryTimeLineCB","parseInt","getDemographicsData","countryName","a","fetch","resp","json","responseData","today","dateChecked","split","stateData","stateName","death","positive","timeLine","active","deaths","allCountryData","data","latest_data","confirmed","recovered","code","countryCode","countryTimelineData","timeline","dailyData","date","Actions","theme","createStyles","formControl","minWidth","RegionSelect","createRegionData","regionMap","regionArray","key","push","FormControl","InputLabel","label","Select","native","initialState","reduce","sliderValues","infectionStartDate","Date","root","paddingLeft","paddingRight","divider","marginTop","marginBottom","paddingBottom","textItemStyle","paddingTop","reducer","action","type","CHANGE_SLIDER_VALUE","sliderName","CHANGE_START_DATE","CHANGE_POPULATION","totalPopulation","Number","CHANGE_BEDS","totalHospitalBeds","CHANGE_INITIAL_NUMBER_OF_CASES","initialNumberOfCases","CHANGE_ICU_BEDS","totalICUBeds","ShutdownScenarios","Controls","Math","ceil","useReducer","dispatch","useEffect","onSliderChange","onPopulationChange","target","onNumberOfCasesChanged","onBedsChanged","onICUBedsChanged","Paper","elevation","style","TextField","map","margin","isMobile","window","innerWidth","chartContainer","height","zoom","Chart","config","containerProps","highcharts","Highcharts","options","gridContainer","renderGridCell","isShutdown","cellElement","bgColor","text","Table","columns","customizeCellValue","cellInfo","shortNum","elementAttr","class","allowColumnReordering","allowColumnResizing","showRowLines","dataSource","showBorders","c","dataField","cellRender","customizeText","mode","padding","marginLeft","marginLeftAuto","ShutdownRange","shutdownWeeks","startDate","computeOptimalWeeks","onDoNotOptimizeToggle","ranges","setState","isWeekView","setIsWeekView","setShutdownState","shutdown","range","start","differenceInWeeks","end","i","Array","fill","getShutdownWeeks","currentRange","length","addWeeks","getShutdownRanges","removeRange","idx","splice","changeRange","onWeekToggle","evt","checked","justify","IconButton","onClick","rangeStart","size","Checkbox","color","maxHeight","overflowY","overflowX","week","Switch","aria-label","Button","startIcon","Week","params","weekStartDate","weekNum","healthy","newInfected","totalInfected","currentlyInfected","dead","hospitalized","Object","assign","this","generateData","controls","R0","shutdownR0","mortalityRate","mortalityRateOverflow","hospitalizationRate","hospitalStayInWeeks","lastWeekNum","weeks","maxICUBeds","shutdowns","r","fractionHealthy","mortality","weightedAverage","floor","round","p0","p1","w0","w1","CHANGE_CONTROL","CHANGE_SHUTDOWN","generateChartConfig","weeksToGo","currentWeekNum","differenceInCalendarWeeks","getWeeksToGo","series","obj","keys","visible","x","y","values","createSeries","subtitle","yAxis","gridLineWidth","xAxis","plotBands","s","from","to","plotLines","plotOptions","line","lineWidth","formatter","format","responsive","rules","condition","maxWidth","chartOptions","getOptimalWeeks","currentNewInfected","shutdownsToZero","getDeprecatingOptimalWeeks","current","next","next2","computeNextWeek","prev","prev2","prev3","result","flexGrow","Headline","leftPanel","flex","grow","flexBasis","minHeight","contentContainer","content","display","flexDirection","noMobile","TABLE_COLUMNS","initialShutdownWeeks","Simulator","useGenerateConfig","onControlChange","onShutdownChange","optimalWeeks","setOptimalWeeks","isTableView","setIsTableView","doNotOptimize","setDoNotOptimize","utils","DateFnsUtils","numWeeks","isNaN","wrap","menuButton","marginRight","urlParams","qs","parse","location","search","App","covidDataLoaded","isEmbed","embed","AppBar","position","Toolbar","edge","open","Container","Boolean","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister","message"],"mappings":"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","file":"static/js/main.3f383ce3.chunk.js","sourcesContent":["import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport {Slider as MaterialSlider, SliderProps as MaterialSliderProps} from '@material-ui/core';\nimport Tooltip from '@material-ui/core/Tooltip';\n\nimport { Grid } from '@material-ui/core';\nimport './slider.css';\n\ninterface SliderProps {\n    title: string;\n    percent?: boolean;\n    onChange: (name: string, value: number) => void;\n    tooltip?: string;\n}\n\nconst useStyles = makeStyles({\n    slider: {\n      width: 150,\n    },\n  });\n  \n\nexport const Slider: React.FC<SliderProps & Omit<MaterialSliderProps, 'onChange'>> = ({title, onChange, percent = false, tooltip, ...props}) => {\n    const classes = useStyles()\n\n    const getValue = (value: number | undefined) => {\n        if(value === undefined) {\n            return '';\n        }\n\n        if(percent) {\n            return `${value}%`;\n        }\n        return value;\n    }\n\n    const onSliderChange = (event, value?) => {\n        onChange(props.name, value);\n    }\n\n    return (\n        <Grid container direction=\"column\" alignItems=\"flex-start\" spacing={0}>\n            <Tooltip title={tooltip} placement=\"right\">\n                <Grid item container direction=\"row\" spacing={1} alignItems=\"center\">\n                    <Grid item>\n                        <Typography>\n                            {getValue(props.min)}\n                        </Typography>\n                    </Grid>\n                    <Grid item className={classes.slider}>\n                        <MaterialSlider\n                            aria-labelledby=\"discrete-slider\"\n                            valueLabelDisplay=\"on\"\n                            valueLabelFormat={getValue}\n                            onChangeCommitted={onSliderChange}\n                            {...props}\n                        />\n                    </Grid>\n                    <Grid>\n                        <Typography>\n                            {getValue(props.max)}\n                        </Typography>\n                    </Grid>\n                    \n                </Grid>\n            </Tooltip>\n\n            <Grid item>\n                <Typography id=\"discrete-slider\" variant=\"caption\">\n                    {title}\n                </Typography>\n            </Grid>\n        </Grid>\n    )\n}","export const sliders = [\n    {\n        title: 'Average spread (R0)',\n        name: 'R0',\n        min: 0,\n        max: 3.0,\n        step: 0.1,\n        defaultValue: 2.2,\n        tooltip: 'Average number of people a single person infects.'\n    },\n    {\n        title: 'Average spread shutdown (R0)',\n        name: 'shutdownR0',\n        min: 0,\n        max: 3.0,\n        step: 0.1,\n        defaultValue: 1.0,\n        tooltip: 'Average number of people a single person infects\\n when we are in a shutdown.'\n    },\n    {\n        title: 'Mortality Rate',\n        name: 'mortalityRate',\n        min: 0,\n        max: 5.0,\n        step: 0.1,\n        defaultValue: 0.5,\n        percent: true,\n        tooltip: 'Percentage of people who die due to the disease.'\n    },\n    {\n        title: 'Mortality Rate Overflow',\n        name: 'mortalityRateOverflow',\n        min: 0,\n        max: 7.0,\n        step: 0.5,\n        defaultValue: 3.0,\n        percent: true,\n        tooltip: 'Percentage of people who die due to the disease, when the medical system is over stressed.'\n    },\n    {\n        title: 'Hospitalization Rate',\n        name: 'hospitalizationRate',\n        min: 0,\n        max: 25,\n        step: 1,\n        defaultValue: 15,\n        percent: true,\n        tooltip: 'Percentage of people who need hospitalization.'\n    },\n    {\n        title: 'Hospital stay in weeks',\n        name: 'hospitalStayInWeeks',\n        min: 0,\n        max: 3,\n        step: 0.5,\n        defaultValue: 1,\n        tooltip: 'Number of weeks a patient needs to stay in the hospital for.'\n    }\n];","import React from 'react';\nimport {default as unsortedCountryStateData} from \"./generated-data/country-state-data.json\";\nimport {default as stateCodeMapping} from \"./generated-data/us-country-code-data.json\";\nimport {default as countryApiMapping} from \"./generated-data/country-api-mapping.json\"\n\nlet USStateInfectedData = new Map();\nlet countryInfectedData = new Map();\nexport let USStateData = new Map();\nexport let countryData = new Map();\nlet timeLineData = new Map();\nlet stateCodeMap = new Map();\nlet countryNameApiMapping = new Map();\nlet countryCodeMapping = new Map();\nexport const UnitedStates= \"USA\";\n\nconst countryStateData = unsortedCountryStateData.sort((v1, v2) => {\n    if(v1.country < v2.country) {\n        return -1;\n    } else {\n        return 1;\n    }\n});\n\nexport const useInitCovidData = () => {\n    let [loaded, setLoaded] = React.useState(false);\n    if(loaded) {\n        return loaded;\n    }\n    initData();\n    initStateMappingCode();\n    initCountryNameApiMapping();\n    initCovidData()\n        .then(() => {\n            setLoaded(true);\n        });\n    return loaded;\n};\n\nexport const getCovidData = (placeName: string) => {\n    let newPlaceName = countryNameApiMapping.has(placeName)\n        ? countryNameApiMapping.get(placeName)\n        : placeName;\n    if(!timeLineData.has(newPlaceName)) {\n        countryTimeLineCB(newPlaceName);\n    }\n    return parseInt(USStateInfectedData.get(newPlaceName)\n        || countryInfectedData.get(newPlaceName)\n        || 0);\n};\n\nexport const getDemographicsData = (placeName: string) => {\n    return countryData.get(placeName) || USStateData.get(placeName);\n};\n\nexport const getCovidDataForDate = (placeName: string,\n                                    date: string) => {\n    return timeLineData.has(placeName)\n        ? timeLineData.get(placeName).date\n        : {};\n};\n\nexport const countryTimeLineCB  = (countryName) => {\n    getCountrySpecificData(countryCodeMapping.get(countryName))\n        .catch(() => console.log(`Error while getting data for ${countryName}`));\n};\n\nfunction initData() {\n    countryStateData.forEach(value => {\n         value.country != value.state\n             ? USStateData.set(value.state, {\n                 population: value.population,\n                 hospitalBeds: value.hospitalBeds,\n                 icuBeds: value.icuBeds\n             })\n             : countryData.set(value.country,{\n                 population: value.population,\n                 hospitalBeds: value.hospitalBeds,\n                 icuBeds: value.icuBeds\n             });\n    });\n}\n\nfunction initStateMappingCode() {\n    stateCodeMapping.forEach((value) => {\n        stateCodeMap.set(value.Code, value.State);\n        timeLineData.set(value.State, {});\n    })\n}\n\nfunction initCountryNameApiMapping () {\n    countryApiMapping.forEach(value => countryNameApiMapping.set(value.Country_Name, value.Api_Mapping));\n}\n\nasync function initStateCovidData() {\n    let resp = await fetch(\"https://cors-anywhere.herokuapp.com/https://covidtracking.com/api/states/daily\");\n    let responseData = await resp.json();\n    let today = responseData[0].dateChecked.split('T')[0];\n    let stateName;\n    let timeLine;\n    for(let stateData of responseData) {\n        stateName = stateCodeMap.get(stateData.state);\n        if(stateName) {\n            stateData.death = stateData.death==null? 0: stateData.death;\n            stateData.dateChecked = stateData.dateChecked.split('T')[0];\n\n            if (stateData.dateChecked ==  today) {\n                USStateInfectedData.set(stateName, stateData.positive - stateData.death);\n            } else if(stateData.dateChecked > today) {\n                today = stateData.dateChecked;\n                USStateInfectedData = new Map();\n                USStateInfectedData.set(stateName, stateData.positive - stateData.death);\n            }\n            timeLine = timeLineData.get(stateName);\n            timeLine[stateData.dateChecked] = {\n                active: stateData.positive,\n                deaths: stateData.death\n            };\n            timeLineData.set(stateName, timeLine);\n        }\n    }\n}\n\nasync function initCountryCovidData() {\n    let resp = await fetch('https://cors-anywhere.herokuapp.com/https://corona-api.com/countries');\n    let responseData = await resp.json();\n    let allCountryData = responseData.data;\n    for(let countryData of allCountryData) {\n        let latest_data = countryData.latest_data;\n        countryInfectedData.set(countryData.name, latest_data.confirmed - latest_data.recovered - latest_data.deaths );\n        countryCodeMapping.set(countryData.name, countryData.code);\n    }\n}\n\nasync function getCountrySpecificData(countryCode :string) {\n    let resp = await fetch(`https://cors-anywhere.herokuapp.com/https://corona-api.com/countries/${countryCode}`);\n    let responseData = await resp.json();\n    let countryName = responseData.data.name;\n    let countryTimelineData = responseData.data.timeline;\n    let timeLine ={};\n\n    for(let dailyData of countryTimelineData) {\n        timeLine[dailyData.date] = {\n            active: dailyData.active,\n            deaths: dailyData.deaths\n        }\n    }\n    timeLineData.set(countryName, timeLine);\n}\n\n\nfunction initCovidData() {\n    return Promise.all([\n        initStateCovidData(),\n        initCountryCovidData(),\n        getCountrySpecificData(\"US\")\n    ]).then(() => {\n        console.log('Done');\n    }).catch((error)=> {\n        console.log(\"Error while fetching data\");\n    });\n\n}\n","import React from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport {\n    countryData,\n    UnitedStates,\n    USStateData\n} from \"../../data-store\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        formControl: {\n            minWidth: 120,\n        },\n    }),\n);\n\nexport default function RegionSelect(props) {\n    const classes = useStyles();\n\n    const createRegionData = (regionMap) => {\n        let regionArray = [];\n        regionMap.forEach((value, key) => {\n            regionArray.push(<option value={key}>{key}</option>);\n        });\n        return regionArray;\n    };\n\n    return (\n        <div>\n            <FormControl className={classes.formControl}>\n                <InputLabel>{props.label}</InputLabel>\n                <Select native defaultValue=\"United States\" onChange={props.onChange}>\n                    <option value={UnitedStates}>{UnitedStates}</option>\n                    <optgroup label=\"States in USA\">\n                        {createRegionData(USStateData)}\n                    </optgroup>\n                    <optgroup label=\"Countries\">\n                        {createRegionData(countryData)}\n                    </optgroup>\n                </Select>\n            </FormControl>\n        </div>\n    );\n}\n","import React, { useEffect } from 'react';\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles';\nimport { Grid } from '@material-ui/core';\nimport { Button, Typography } from '@material-ui/core';\nimport Paper from '@material-ui/core/Paper';\nimport TextField from '@material-ui/core/TextField';\nimport {\n    KeyboardDatePicker,\n  } from '@material-ui/pickers';\nimport {Slider} from '../slider/slider';\nimport {sliders} from './controls-data';\nimport RegionSelect from \"../region-select/region-select\";\nimport {\n    getCovidData,\n    getDemographicsData,\n    UnitedStates\n} from \"../../data-store\";\n\nexport interface ControlState {\n    R0?: number;\n    shutdownR0?: number;\n    mortalityRate?: number;\n    mortalityRateOverflow?: number;\n    hospitalizationRate?: number;\n    hospitalStayInWeeks?: number;\n    infectionStartDate?: Date;\n    initialNumberOfCases?: number;\n    totalPopulation?: number;\n    totalHospitalBeds?: number;\n    totalICUBeds?: number;\n}\n\ninterface Props {\n    onChange?: (controls: ControlState) => void;\n}\n\nenum Actions {\n    CHANGE_SLIDER_VALUE,\n    CHANGE_START_DATE,\n    CHANGE_POPULATION,\n    CHANGE_INITIAL_NUMBER_OF_CASES,\n    CHANGE_BEDS,\n    CHANGE_ICU_BEDS\n}\n\nconst initialState: ControlState = sliders.reduce((sliderValues, slider) => {\n    sliderValues[slider.name] = slider.defaultValue;\n    return sliderValues;\n}, {});\ninitialState.infectionStartDate = new Date();\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      paddingLeft: theme.spacing(6),\n      paddingRight: theme.spacing(2)\n    },\n    divider: {\n        marginTop: theme.spacing(2),\n        marginBottom: theme.spacing(2)\n    },\n    title: {\n        paddingBottom: 0\n    }\n  }),\n);\n\nconst textItemStyle = { paddingTop: 12, paddingBottom: 12 };\n\n\nfunction reducer(state, action) {\n    switch(action.type) {\n        case Actions.CHANGE_SLIDER_VALUE:\n            return {\n                ...state,\n                [action.sliderName]: action.value\n            }\n        case Actions.CHANGE_START_DATE:\n            return {\n                ...state,\n                infectionStartDate: action.infectionStartDate\n            }\n        case Actions.CHANGE_POPULATION:\n            return {\n                ...state,\n                totalPopulation: Number(action.value)\n            }\n        case Actions.CHANGE_BEDS:\n            return {\n                ...state,\n                totalHospitalBeds: Number(action.value)\n            }\n        case Actions.CHANGE_INITIAL_NUMBER_OF_CASES:\n            return {\n                ...state,\n                initialNumberOfCases: Number(action.value)\n            }\n        case Actions.CHANGE_ICU_BEDS:\n            return {\n                ...state,\n                totalICUBeds: Number(action.value)\n            }\n        \n        default:\n            return state;\n    }\n}\n\nexport const Controls: React.FC<Props> = ({ onChange }) => {\n    const classes = useStyles();\n    initialState.initialNumberOfCases = getCovidData(UnitedStates);\n    let data = getDemographicsData(UnitedStates);\n    initialState.totalPopulation = Math.ceil(Number(data.population)/1000000) * 1000000;\n    initialState.totalHospitalBeds = Number(data.hospitalBeds);\n    initialState.totalICUBeds = Number(data.icuBeds);\n    const [state, dispatch] = React.useReducer(reducer, initialState);\n\n    useEffect(() => {\n        onChange(state);\n    }, [state]);\n\n    const onSliderChange = (sliderName: string, value?) => {\n        dispatch({\n            type: Actions.CHANGE_SLIDER_VALUE,\n            sliderName,\n            value\n        });\n    };\n\n    const onDateChange = (infectionStartDate: Date) => {\n        dispatch({\n            type: Actions.CHANGE_START_DATE,\n            infectionStartDate\n        })\n    };\n\n    const onPopulationChange = (event, value?) => {\n        dispatch({\n            type: Actions.CHANGE_POPULATION,\n            value: value||event.target.value\n        })\n    };\n\n    const onNumberOfCasesChanged = (event, value?) => {\n        dispatch({\n            type: Actions.CHANGE_INITIAL_NUMBER_OF_CASES,\n            value: value === undefined\n                ? event.target.value\n                : value\n        })\n    };\n\n    const onBedsChanged = (event, value?) => {\n        dispatch({\n            type: Actions.CHANGE_BEDS,\n            value: value||event.target.value\n        })\n    };\n\n    const onICUBedsChanged = (event, value?) => {\n        dispatch({\n            type: Actions.CHANGE_ICU_BEDS,\n            value: value||event.target.value\n        })\n    };\n\n    const onRegionChanged = (event) => {\n        let placeName = event.target.value;\n        onNumberOfCasesChanged(undefined, getCovidData(placeName));\n        let data = getDemographicsData(placeName);\n        onPopulationChange(undefined, Math.ceil(data.population/100000)*100000);\n        onBedsChanged(undefined, data.hospitalBeds);\n        onICUBedsChanged(undefined, data.icuBeds);\n    };\n\n    return (\n            <Paper elevation={3} className={classes.root}>\n                <Grid container direction=\"column\" alignItems=\"flex-start\">\n                    <Grid item style={{...textItemStyle, paddingTop: 20}}>\n                        <RegionSelect onChange={onRegionChanged} label=\"Country / State\"></RegionSelect>\n                    </Grid>\n                    <Grid item style={textItemStyle}>\n                        <TextField label=\"Total population\"\n                                   onChange={onPopulationChange}\n                                   value={state.totalPopulation}></TextField>\n                    </Grid>\n                    <Grid item style={textItemStyle}>\n                        <KeyboardDatePicker \n                            onChange={onDateChange}\n                            variant=\"inline\" value={state.infectionStartDate} label='Start date'></KeyboardDatePicker>\n                    </Grid>\n                    <Grid item style={textItemStyle}>\n                        <TextField label=\"Active cases\"\n                            onChange={onNumberOfCasesChanged}\n                            value={state.initialNumberOfCases}></TextField>\n                    </Grid>\n                    <Grid item style={textItemStyle}>\n                        <TextField label=\"Approx. hospital beds\"\n                            onChange={onBedsChanged}\n                            value={state.totalHospitalBeds}></TextField>\n                    </Grid>\n                    <Grid item style={{paddingBottom: 32}}>\n                        <TextField label=\"Approx. ICU  beds\"\n                                   onChange={onICUBedsChanged}\n                                   value={state.totalICUBeds}></TextField>\n                    </Grid>\n                    {sliders.map(slider => <Grid item key={slider.name} style={{ margin: '32px 0'}}> \n                        <Slider {...slider} onChange={onSliderChange}></Slider>\n                    </Grid>)}\n                </Grid>\n            </Paper>\n               \n    )\n}\n","import React from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport {\n  MuiPickersUtilsProvider,\n  KeyboardTimePicker,\n  KeyboardDatePicker,\n} from '@material-ui/pickers';\nimport Checkbox, { CheckboxProps } from '@material-ui/core/Checkbox';\nimport { addWeeks, eachWeekOfInterval, differenceInWeeks } from 'date-fns';\nimport Grid from '@material-ui/core/Grid';\nimport { Button, Typography } from '@material-ui/core';\nimport AddIcon from '@material-ui/icons/Add';\nimport DateRangeIcon from '@material-ui/icons/DateRange';\nimport IconButton from '@material-ui/core/IconButton';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport RotateLeftIcon from '@material-ui/icons/RotateLeft';\nimport Paper from '@material-ui/core/Paper';\nimport Switch from '@material-ui/core/Switch';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Select from '@material-ui/core/Select';\n\n\nenum ShutdownScenarios {\n    TWO_MONTHS,\n    FOUR_MONTHS,\n    SIX_MONTHS,\n    OPTIMAL,\n    CUSTOM\n}\n\nexport interface Range {\n    start: Date,\n    end: Date\n};\n\nexport type ShutdownRangeState = {\n    shutdownWeeks: boolean[];\n    ranges: Range[]\n};\n\ninterface Props {\n    onChange: (ranges: ShutdownRangeState) => void;\n    computeOptimalWeeks: () => void;\n    shutdownWeeks?: boolean[];\n    startDate?: Date;\n    onDoNotOptimizeToggle?: (optimize: boolean) => void;\n}\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n        padding: theme.spacing(4)\n    },\n    marginBottom: {\n        marginBottom: theme.spacing(2)\n    },\n    marginTop: {\n        marginTop: theme.spacing(2)\n    },\n    marginLeft: {\n        marginLeft: theme.spacing(2)\n    },\n    marginLeftAuto: {\n        marginLeft: 'auto'\n    }\n  }),\n);\n\nexport const ShutdownRange: React.FC<Props> = ({ shutdownWeeks, startDate, computeOptimalWeeks, onChange, onDoNotOptimizeToggle }) => {\n    const classes = useStyles();\n    const [state, setState] = React.useState({ shutdownWeeks: [], ranges: []})\n    const [isWeekView, setIsWeekView] = React.useState(false);\n\n    const setShutdownState = (ranges: Range[], shutdownWeeks: boolean[]) => {\n        if(!shutdownWeeks) {\n            shutdownWeeks = getShutdownWeeks(ranges, startDate);\n        }\n\n        if(!ranges) {\n            ranges = getShutdownRanges(startDate, shutdownWeeks);\n        }\n\n        setState({ranges, shutdownWeeks});\n    }\n\n    React.useEffect(() => {\n        onChange(state);\n    }, [state]);\n\n    React.useEffect(() => {\n        if((!shutdownWeeks || !startDate)) {\n            return;\n        }\n        setShutdownState(null, shutdownWeeks);\n    }, [shutdownWeeks, startDate]);\n\n    const addRange = () => {\n        let rangeStart = state.ranges[state.ranges.length - 1]?.end || new Date();\n        const range = {\n            start: rangeStart,\n            end: rangeStart\n        }\n        setShutdownState([\n            ...state.ranges,\n            range\n        ], null);\n    }\n\n    const removeRange = (idx: number) => () => {\n        state.ranges.splice(idx, 1);\n        setShutdownState([...state.ranges], null);\n    }\n\n    const changeRange = range => type => date => {\n        range[type] = date;\n        if(type === 'start' && range.end < date) {\n            range.end = date;\n        }\n        setShutdownState([...state.ranges], null);\n    }\n\n    const onWeekViewToggle = (evt) => {\n        setIsWeekView(evt.target.checked);\n    }\n\n    const onWeekToggle = (evt) => {\n        state.shutdownWeeks[Number(evt.target.id)] = evt.target.checked;\n        setShutdownState(null, [...state.shutdownWeeks]);\n    }\n\n    const onDoNotOptimize = (evt) => {\n        onDoNotOptimizeToggle(evt.target.checked);\n    }\n\n    const onOptimizeClick = () => {\n        onDoNotOptimizeToggle(false);\n        computeOptimalWeeks();\n    }\n\n    const onCustomizeClick = () => {\n        onDoNotOptimizeToggle(false);\n        setShutdownState([], null);\n    }\n\n    const renderRanges = () => state.ranges.map((range, idx) => <Grid container item direction=\"row\" spacing={4} alignItems=\"center\">\n        <Grid item><KeyboardDatePicker variant=\"inline\" onChange={changeRange(range)('start')}  value={range.start} label='Start'></KeyboardDatePicker></Grid>\n        <Grid item><KeyboardDatePicker variant=\"inline\" onChange={changeRange(range)('end')}  value={range.end} label='End'></KeyboardDatePicker></Grid>\n        <Grid item>\n            <IconButton onClick={removeRange(idx)} aria-label=\"delete\">\n                <DeleteIcon />\n            </IconButton>\n        </Grid>\n    </Grid>);\n\n    const renderWeeks = () => <Grid item container direction=\"row\">\n        {state.shutdownWeeks.map((week, idx) => \n            <Grid item>\n                <Grid container alignItems=\"center\">\n                    <Switch color=\"primary\" id={idx + ''} checked={week} onChange={onWeekToggle}></Switch>\n                    <Typography variant=\"caption\">{`Week ${idx + 1}`}</Typography>\n                </Grid>\n            </Grid>\n        )}\n    </Grid>\n\n    return (\n        <Paper elevation={3} className={classes.root}>\n            <Grid container direction=\"column\" alignItems=\"flex-start\" spacing={2}>\n                <Grid container alignItems=\"center\" justify=\"space-between\">\n                    <Grid item>\n                        <Grid container direction=\"row\" alignItems=\"center\">\n                            <Tooltip title=\"Weeks when we will have a shutdown.\">\n                                <Typography>Shutdown Dates</Typography>\n                            </Tooltip>\n                            <IconButton onClick={addRange} size=\"small\" style={{ marginLeft: 10}}> <AddIcon/> </IconButton>    \n                        </Grid>\n                        \n                    </Grid>\n                    \n                    <Grid item>\n                        <Grid container alignItems=\"center\">\n                            {/* <Checkbox color=\"primary\" onChange={onDoNotOptimize}></Checkbox>\n                            <Typography variant=\"body2\">Do not optimize</Typography> */}\n                            <Checkbox color=\"primary\" onChange={onWeekViewToggle}></Checkbox>\n                            <Typography variant=\"body2\">Week view</Typography>\n                        </Grid>\n                    </Grid>\n                </Grid>\n                <Grid container item spacing={2} style={{ maxHeight: 400, overflowY: `auto`, overflowX: 'hidden' }}>\n                    {(isWeekView) ? renderWeeks() : renderRanges()}\n                </Grid>\n                <Grid container item className={classes.marginTop} spacing={2} alignItems=\"center\">                    \n                    {/* <Button variant=\"contained\" color=\"primary\"\n                        startIcon={<RotateLeftIcon />} onClick={onCustomizeClick}>Customize</Button> */}\n                    <Button \n                        variant=\"contained\" startIcon={<DateRangeIcon />}  size=\"large\"\n                            onClick={onOptimizeClick} color=\"primary\">Optimize shutdowns</Button>    \n                </Grid>\n            </Grid>\n        </Paper>\n    )\n}\n\n\nfunction getShutdownRanges(startDate: Date, shutdownWeeks: boolean[]): Range[] {\n    let ranges = [];\n    let currentRange = null;\n    for(let i = 0; i<shutdownWeeks.length; i++) {\n        if(!shutdownWeeks[i] && currentRange) {\n            ranges.push(currentRange);\n            currentRange = null;\n        }\n\n        if(shutdownWeeks[i]) {\n            if(currentRange) {\n                currentRange.end = addWeeks(currentRange.end, 1);\n            } else {\n                currentRange = {\n                    start: addWeeks(startDate, i),\n                    end: addWeeks(startDate, i+1)\n                }\n            }\n        }\n    }\n    if(currentRange) {\n        ranges.push(currentRange);\n    }\n\n    return ranges;\n}\n\nfunction getShutdownWeeks(ranges, startDate) {\n    return ranges.reduce((shutdown, range) => {\n        let start = differenceInWeeks(range.start, startDate);\n        let end = differenceInWeeks(range.end, startDate);\n        for(let i = start; i < end; i++) {\n            shutdown[i] = true;\n        }\n        return shutdown;\n    }, Array(104).fill(false));\n}\n\nexport function getNumShutdownWeeks(shutdownWeeks: boolean[]) {\n    return shutdownWeeks.reduce((numWeeks, shutdown) => {\n        return numWeeks + ((shutdown) ? 1 : 0);\n    }, 0)\n}","export const MOBILE_WIDTH = 500;\n\nexport const isMobile = () => {\n    return window.innerWidth < MOBILE_WIDTH;\n}","import React from 'react';\nimport Highcharts from 'highcharts'\nimport HighchartsReact from 'highcharts-react-official'\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles';\nimport { Paper } from '@material-ui/core';\nimport { isMobile } from '../../services/viewport-service';\n\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    divider: {\n        marginTop: theme.spacing(2),\n        marginBottom: theme.spacing(2)\n    },\n    chartContainer: {\n        height: (isMobile()) ? 400 : 700,\n        zoom: (isMobile()) ? 0.8 : 1,\n    }\n  }),\n);\n\ninterface Props {\n    config: any;\n}\n\nexport const Chart: React.FC<Props> = ({ config }) => {\n    const classes = useStyles();\n\n    return <HighchartsReact\n            containerProps = {{ className: classes.chartContainer }}\n            highcharts={Highcharts}\n            options={config}\n      />;\n}","import React from 'react';\nimport DataGrid, { Scrolling, Column } from 'devextreme-react/data-grid';\nimport 'devextreme/dist/css/dx.common.css';\nimport 'devextreme/dist/css/dx.light.css';\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles';\nimport { Paper } from '@material-ui/core';\nimport shortNum from 'short-number';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      width: '100%',\n      height: '100%'\n    },\n    divider: {\n        marginTop: theme.spacing(2),\n        marginBottom: theme.spacing(2)\n    },\n    gridContainer: {\n        height: 600\n    }\n  }),\n);\n\ninterface Props {\n    columns: string[];\n    data: {[key: string]: number | string}[]\n}\n\nconst renderGridCell = (data) => {\n    if(data.data.isShutdown) {\n        data.cellElement.bgColor = '#ffcccb';\n    }\n\n    return data.text;\n}\n\nexport const Table: React.FC<Props> = ({ columns, data }) => {\n    const classes = useStyles();\n\n    const customizeCellValue = (cellInfo) => {\n        if(typeof cellInfo.value === 'number') {\n            return shortNum(cellInfo.value) + '';\n        }\n\n        return cellInfo.value + '';\n    }\n\n    return <div className={classes.root}>\n        <DataGrid\n            elementAttr={{\n                class: classes.gridContainer\n            }}\n            allowColumnReordering={true}\n            allowColumnResizing={true}\n            showRowLines={true}\n            // @ts-ignore\n            dataSource={data}\n            showBorders={true}>\n            {columns.map(c => <Column \n                dataField={c}\n                cellRender={renderGridCell}\n                customizeText={customizeCellValue}/>)}\n            <Scrolling mode=\"virtual\" />\n        </DataGrid>\n    </div>\n}\n","import React, { useReducer, useEffect } from 'react';\nimport shortNum from 'short-number';\nimport { format, differenceInCalendarWeeks } from 'date-fns';\nimport { SimulatorInputState, generateData} from './data-generator';\nimport { ShutdownRangeState } from '../shudown-range/shutdown-range';\nimport { MOBILE_WIDTH } from '../../services/viewport-service';\n\nenum Actions {\n    CHANGE_CONTROL,\n    CHANGE_SHUTDOWN\n}\n\nconst reducer = (state: SimulatorInputState, action) => {\n    switch(action.type) {\n        case Actions.CHANGE_CONTROL:\n            return {\n                ...state,\n                controls: action.controls\n            }\n        case Actions.CHANGE_SHUTDOWN:\n            return {\n                ...state,\n                shutdowns: action.shutdowns\n            }\n        \n        default:\n            return state;\n    }\n}\n\nexport const useGenerateConfig = (): [SimulatorInputState, any, any, any] => {\n    const [state, dispatch] = useReducer(reducer, {\n        controls: {},\n        shutdowns: {\n            ranges: [],\n            shutdownWeeks: []\n        }\n    });\n    return [\n        state,\n        generateChartConfig(state),\n        (controls) => dispatch({type: Actions.CHANGE_CONTROL, controls}),\n        (shutdowns) => dispatch({type: Actions.CHANGE_SHUTDOWN, shutdowns})\n    ];\n}\n\n\n\n\nfunction generateChartConfig(state: SimulatorInputState) { \n    // TODO: Generate chart config here.\n    let {weeks, lastWeekNum, maxICUBeds} = generateData(state);\n    let weeksToGo = getWeeksToGo(lastWeekNum, state.controls.infectionStartDate);\n    let series = createSeries(weeks);\n    const options = {\n        subtitle: {\n            text: ''\n        },\n        title: {\n          text: ``,\n        },\n        yAxis: {\n            type: 'logarithmic',\n            title: {\n                text: 'Number of people'\n            },\n            gridLineWidth: 1,\n        },\n        xAxis: {\n            type: 'datetime',\n            title: {\n                text: 'Date'\n            },\n            gridLineWidth: 1,\n            plotBands: createShutdownBands(state.shutdowns.ranges),\n            plotLines: [{\n                value: weeks[lastWeekNum]?.weekStartDate,\n                color: '#013220'\n            }]\n        },\n        plotOptions: {\n            line: {\n                lineWidth: 5\n            }\n        },\n        tooltip: {\n            formatter: function () {\n                return `<b>${this.series.name}</b>:${shortNum(this.y)} <br>` +\n                    `${format(this.x, 'do MMM y')}`;\n            }\n        },\n        responsive: {\n            rules: [{\n                condition: {\n                    maxWidth: MOBILE_WIDTH\n                },\n                chartOptions: {\n                    plotOptions: {\n                        line: {\n                            lineWidth: 3\n                        }\n                    }\n                }\n            }]\n        },\n        series\n    }\n\n    console.log(options);\n    return {\n        config: options,\n        weeks,\n        weeksToGo,\n        maxICUBeds\n    };\n}\n\nfunction createShutdownBands(shutdowns: {start: Date, end: Date}[]) {\n    return shutdowns.map(s => {\n        return {\n            color: '#ffcccb',\n            from: s.start,\n            to: s.end\n        };\n    })\n}\n\n\nfunction createSeries(data) {\n    let series = {};\n    data.forEach(obj => {\n        Object.keys(obj).forEach(key => {\n            series[key] = series[key] || {name: key, data: [], visible: false};\n            series[key].data.push({\n                x: obj.weekStartDate,\n                y: obj[key]\n            });\n        });\n    });\n    delete series['week'];\n    delete series['weekNum'];\n    delete series['healthy'];\n    delete series['weekStartDate'];\n    delete series['recovered'];\n    delete series['isShutdown'];\n    delete series['currentlyInfected'];\n\n    series['hospitalized'].visible = true;\n    series['dead'].visible = true;\n    series['newInfected'].visible = true;\n    return Object.values(series);\n}\n\nfunction getWeeksToGo(lastWeekNum, startDate) {\n    const currentWeekNum = differenceInCalendarWeeks(new Date(), startDate);\n    return lastWeekNum - currentWeekNum;\n}","import { addWeeks, isWithinInterval } from 'date-fns';\nimport { ControlState } from '../controls/controls';\nimport { ShutdownRangeState } from '../shudown-range/shutdown-range';\n\nexport interface SimulatorInputState {\n    controls: ControlState;\n    shutdowns: ShutdownRangeState;\n}\n\nexport class Week {\n    weekStartDate: Date;\n    weekNum: number;\n    healthy: number = 0;\n    newInfected: number = 0;\n    totalInfected: number = 0;\n    currentlyInfected = 0;\n    recovered = 0;\n    dead = 0;\n    hospitalized = 0;\n    isShutdown: boolean = false;\n\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n}\n\nexport function generateData(state: SimulatorInputState) {\n    let {\n        totalPopulation,\n        infectionStartDate,\n        R0,\n        shutdownR0,\n        mortalityRate,\n        mortalityRateOverflow,\n        initialNumberOfCases,\n        hospitalizationRate,\n        totalHospitalBeds,\n        hospitalStayInWeeks } = state.controls;\n    mortalityRate = mortalityRate / 100;\n    mortalityRateOverflow = mortalityRateOverflow / 100;\n    hospitalizationRate = hospitalizationRate / 100;\n\n    let weeks = [new Week({\n        weekStartDate: infectionStartDate,\n        weekNum: 0,\n        healthy: totalPopulation - initialNumberOfCases,\n        newInfected: initialNumberOfCases,\n        totalInfected: initialNumberOfCases,\n        currentlyInfected: initialNumberOfCases,\n        recovered: 0,\n        dead: 0,\n        hospitalized: 0\n    })];\n    let lastWeekNum, maxICUBeds = 0;\n\n    for(let i=1; i<104; i++) {\n        weeks[i] = new Week();\n        weeks[i].weekStartDate = addWeeks(infectionStartDate, i);\n        weeks[i].weekNum = i;\n        weeks[i].isShutdown = state.shutdowns.shutdownWeeks[i];\n        let r = (weeks[i].isShutdown)\n            ? shutdownR0 \n            : R0;\n\n        let fractionHealthy = (weeks[i-1].healthy) / totalPopulation;\n        let mortality = (weeks[i-1].hospitalized < totalHospitalBeds)\n            ? mortalityRate\n            : weightedAverage(mortalityRate, mortalityRateOverflow,\n                totalHospitalBeds, weeks[i-1].hospitalized - totalHospitalBeds);\n\n        weeks[i].newInfected = Math.floor(weeks[i-1].newInfected * r * fractionHealthy);\n        weeks[i].currentlyInfected = Math.floor(weeks[i].newInfected + weeks[i-1].newInfected\n                + ((i >= 2) ? weeks[i-2].newInfected : 0));\n        weeks[i].totalInfected = weeks[i-1].totalInfected + weeks[i].newInfected;\n\n        // 3 weeks later patients either die or recover.\n        if(i >= 3) {\n            weeks[i].dead = Math.floor(weeks[i-1].dead + weeks[i - 3].newInfected * mortality);\n            weeks[i].recovered = Math.floor(weeks[i-1].recovered + (weeks[i -3].newInfected *  ( 1 - mortality)));\n        }\n        if(i > 2) {\n            weeks[i].hospitalized =  Math.floor(weeks[i -2].newInfected * hospitalizationRate * hospitalStayInWeeks);\n        }\n        weeks[i].healthy = totalPopulation - (weeks[i].currentlyInfected + weeks[i].recovered + weeks[i].dead); \n\n        if(weeks[i].hospitalized * 0.4 > maxICUBeds) {\n            maxICUBeds = Math.round(weeks[i].hospitalized * 0.4);\n        }\n\n        if(weeks[i].currentlyInfected === 0 && !lastWeekNum) {\n            lastWeekNum = i;\n        }\n    }\n\n    return {\n        lastWeekNum,\n        weeks,\n        maxICUBeds\n    };\n}\n\nexport function weightedAverage(p0: number, p1: number, w0: number, w1: number) {\n    return ((p0 * w0) + (p1 * w1)) / (w0 + w1);\n}\n\nfunction isShutdown(week, shutdowns) {\n    try {\n        return  shutdowns.some(shutdown => isWithinInterval(week, shutdown));\n    } catch {\n        return false;\n    }\n}","import { ControlState } from '../controls/controls';\nimport { Week, weightedAverage, generateData } from './data-generator';\nimport { differenceInCalendarWeeks } from 'date-fns';\n\nexport function getOptimalWeeks(state: ControlState) {\n    const {\n        totalPopulation,\n        totalHospitalBeds,\n        shutdownR0,\n        infectionStartDate,\n        initialNumberOfCases\n    } = state;\n\n    let weeks = [new Week({\n        newInfected: initialNumberOfCases,\n        totalInfected: initialNumberOfCases,\n        currentlyInfected: initialNumberOfCases,\n        healthy: totalPopulation - initialNumberOfCases\n    })];\n\n    let shutdown = Array(104).fill(false);\n\n    if(shutdownR0 < 1) {\n        return getDeprecatingOptimalWeeks(state);\n    }\n\n\n    for(let i = 1; i< 104; i++) {\n        let current: Week, next: Week, next2: Week;\n        current = computeNextWeek(state, false,\n            weeks[i - 1], (i >= 2) ? weeks[i-2] : null, (i >= 3) ? weeks[i - 3] : null);\n        next = computeNextWeek(state, true,\n            current, weeks[i-1], (i >= 2) ? weeks[i-2] : null);\n        next2 = computeNextWeek(state, true,\n            next, current, weeks[i-1]);\n\n        if(current.hospitalized > totalHospitalBeds ||\n            next.hospitalized > totalHospitalBeds ||\n            next2.hospitalized > totalHospitalBeds) {\n                shutdown[i] = true;\n                weeks[i] = computeNextWeek(state, shutdown[i],\n                    weeks[i - 1], (i >= 2) ? weeks[i -2] : null, (i >= 3) ? weeks[i - 3] : null);\n        } else {\n            shutdown[i] = false;\n            weeks[i] = current;\n        }\n    }\n\n    return shutdown;\n}\n\nfunction computeNextWeek(state: ControlState, shutdown: boolean, prev: Week, prev2: Week, prev3: Week): Week {\n    let {\n        R0,\n        shutdownR0,\n        totalPopulation,\n        totalHospitalBeds,\n        mortalityRate,\n        mortalityRateOverflow,\n        hospitalizationRate\n    } = state;\n    mortalityRate = mortalityRate / 100;\n    mortalityRateOverflow = mortalityRateOverflow / 100;\n    hospitalizationRate = hospitalizationRate / 100;\n\n    let result: Week = new Week();\n    const r = (shutdown) ? shutdownR0 : R0;\n    const fractionHealthy = prev.healthy / totalPopulation;\n\n    // Mortality depends on how much overflow there is in the hospitals compared capacity\n    let mortality = (prev.hospitalized < totalHospitalBeds) ? mortalityRate :\n        weightedAverage(mortalityRate, mortalityRateOverflow,\n        totalHospitalBeds, prev.hospitalized - totalHospitalBeds);\n    \n    result.newInfected = Math.round(prev.newInfected * r * fractionHealthy);\n    // Last 2 week + current week's newly infected are still infected. \n    result.currentlyInfected = result.newInfected + prev.newInfected + ((prev2 != null) ? prev2.newInfected : 0);\n    result.totalInfected = prev.totalInfected + result.newInfected;\n    // 3 weeks later patients either die or recover.\n    if (prev3 != null) {\n        result.dead = prev.dead + prev3.newInfected * mortality;\n        result.recovered = prev.recovered + (prev3.newInfected *  ( 1 - mortality));\n    }\n    // We are considering that patients are in hopsital in their third week.\n    if (prev2 != null) {\n        result.hospitalized =  prev2.newInfected * hospitalizationRate;\n    } \n    result.healthy = totalPopulation - (result.currentlyInfected + result.recovered + result.dead);\n    return result; \n}\n\nfunction getDeprecatingOptimalWeeks(state: ControlState) {\n    let {\n        R0,\n        shutdownR0,\n        totalPopulation,\n        totalHospitalBeds,\n        infectionStartDate,\n        mortalityRateOverflow,\n        hospitalizationRate\n    } = state;\n    let { weeks } = generateData({ controls: state, shutdowns: {shutdownWeeks: [], ranges: []}});\n    let currentWeekNum = differenceInCalendarWeeks(new Date(), infectionStartDate);\n    let currentNewInfected = weeks[currentWeekNum ].newInfected;\n\n    let shutdownsToZero = Math.ceil(-Math.log(currentNewInfected) / Math.log(shutdownR0));\n\n    let shutdown = Array(104).fill(false);\n    for(let i = currentWeekNum; i<currentWeekNum + shutdownsToZero; i++) {\n        shutdown[i] = true;\n    }\n\n    return shutdown;\n}","import React from 'react';\nimport 'date-fns';\nimport { Grid } from '@material-ui/core';\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles';\nimport {Controls} from '../controls/controls';\nimport {Chart} from '../chart/chart';\nimport { Table } from '../table/table';\nimport {ShutdownRange, getNumShutdownWeeks} from '../shudown-range/shutdown-range';\nimport {useGenerateConfig} from './use-generate-config';\nimport {getOptimalWeeks} from './optimal-weeks-generator';\nimport {\n    MuiPickersUtilsProvider,\n } from '@material-ui/pickers';\nimport shortNum from 'short-number';\nimport Switch from '@material-ui/core/Switch';\nimport { Paper, Typography } from '@material-ui/core';\n\nimport DateFnsUtils from '@date-io/date-fns';\nimport { Headline } from '../headline/headline';\nimport { isMobile } from '../../services/viewport-service';\n\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    leftPanel: {\n        flex: (isMobile()) ? `1 1 300px` : `0 0 300px`\n    },\n    grow: {\n        flexGrow: 1,\n        flexBasis: 0,\n        minHeight: 0\n    },\n    contentContainer: {\n        flex: '1 0 0',\n        minHeight: 390,\n        height: (isMobile()) ? 390 : 800,\n    },\n    content: {\n        padding: (isMobile()) ? 0 : theme.spacing(4),\n        flex: '1 1 0',\n        minHeight: 0,\n        display: 'flex',\n        flexDirection: 'column'\n    },\n    marginBottom: {\n        marginBottom: theme.spacing(2)\n    },\n    noMobile: {\n        display: (isMobile()) ? `none`: 'initial'\n    }\n  }),\n);\n\nconst TABLE_COLUMNS = ['weekNum', 'healthy', 'newInfected', 'totalInfected', 'currentlyInfected', 'dead', 'hospitalized'];\nconst initialShutdownWeeks = Array(104).fill(false);\nfor(let i = 0;i<16;i++) {\n    initialShutdownWeeks[i] = true;\n}\n\nexport const Simulator: React.FC = () => {\n    const classes = useStyles();\n    const [\n        state, \n        {config, weeks, weeksToGo, maxICUBeds},\n        onControlChange, \n        onShutdownChange] = useGenerateConfig();\n    const [optimalWeeks, setOptimalWeeks] = React.useState<boolean[]>(initialShutdownWeeks);\n    const [isTableView, setIsTableView] = React.useState(false);\n    const [doNotOptimize, setDoNotOptimize] = React.useState(true);\n\n    const computeOptimalWeeks = () => {\n        setOptimalWeeks(getOptimalWeeks(state.controls));\n    }\n\n    React.useEffect(() => {\n        if(doNotOptimize) {\n            return;\n        }\n\n        setOptimalWeeks(getOptimalWeeks(state.controls));\n    }, [state.controls])\n\n    return (\n        <MuiPickersUtilsProvider utils={DateFnsUtils}>\n            <Grid container spacing={2} direction='row'>\n                <Grid item className={classes.leftPanel}>\n                    <Controls onChange={onControlChange}></Controls>\n                </Grid>\n                <Grid container item direction=\"column\" className={classes.grow} spacing={2}>\n                    <Grid item className={classes.noMobile}>\n                        <ShutdownRange\n                            shutdownWeeks={optimalWeeks}\n                            startDate={state.controls.infectionStartDate}\n                            computeOptimalWeeks={computeOptimalWeeks}\n                            onDoNotOptimizeToggle={setDoNotOptimize}\n                            onChange={onShutdownChange}></ShutdownRange>\n                    </Grid>\n                    <Grid item container\n                        direction=\"row\"  spacing={2}>\n                        <Grid item className={classes.grow}> \n                            <Headline title=\"Total Shutdown\"\n                                tooltip=\"Total number of weeks of shutdown\"\n                                value={`${getNumShutdownWeeks(state.shutdowns.shutdownWeeks)} weeks`}></Headline>\n                        </Grid>\n                        <Grid item className={classes.grow}> \n                            <Headline \n                                tooltip=\"Number of weeks to complete irradication of coronavirus.\"\n                                title=\"Time before the virus dies\" value={(!isNaN(weeksToGo)) ? `${weeksToGo} weeks` : `> 2 years`}></Headline>\n                        </Grid>\n                        <Grid item className={classes.grow}>\n                            <Headline title=\"Approximate Deaths\"\n                                 tooltip=\"Number of people expected to die due to the Virus.\"\n                                 value={shortNum(weeks[weeks.length - 1].dead)}></Headline>\n                        </Grid>\n                        <Grid item className={classes.grow}>\n                            <Headline title=\"ICU Bed shortage\"\n                                 color=\"secondary\"\n                                 tooltip=\"Number of beds short in the ICU to support the pandemic.\"\n                                 value={shortNum(Math.max(maxICUBeds - state.controls.totalICUBeds, 0))}></Headline>\n                        </Grid>\n                    </Grid>\n                    <Grid item container direction=\"column\" className={classes.contentContainer}>\n                        <Paper elevation={3} className={classes.content}>\n                            <Grid container direction=\"column\" wrap=\"nowrap\" className={classes.grow}>\n                                <Grid item style={{ marginLeft: 'auto'}}>\n                                    <Typography variant=\"caption\">Table View</Typography>\n                                    <Switch color=\"primary\" id='switcher' checked={isTableView} onChange={() => setIsTableView(!isTableView)}></Switch>\n                                </Grid>\n                                <Grid item className={classes.grow} style={{ display: 'flex', flexDirection: 'column', maxWidth: '100vw', minHeight: 336}}>\n                                    {(isTableView) ? <Table\n                                        columns={TABLE_COLUMNS} \n                                        data={weeks}></Table>\n                                        : <Chart config={config}></Chart>}\n                                </Grid>\n                            </Grid>\n                        </Paper>\n                    </Grid>\n                </Grid>\n            </Grid>\n        </MuiPickersUtilsProvider>\n    )\n}","import React from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport Paper from '@material-ui/core/Paper';\nimport { Typography } from '@material-ui/core';\nimport Grid from '@material-ui/core/Grid';\nimport Tooltip from '@material-ui/core/Tooltip';\n\n\ninterface Props {\n    title: string;\n    value: string;\n    tooltip: string;\n    color?: \"primary\" | \"secondary\";\n}\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n        padding: theme.spacing(2),\n        paddingRight: theme.spacing(4),\n        flexGrow: 1,\n        minWidth: 170\n    },\n    marginBottom: {\n        marginBottom: theme.spacing(2)\n    },\n    marginTop: {\n        marginTop: theme.spacing(2)\n    },\n    marginLeft: {\n        marginLeft: theme.spacing(2)\n    },\n    marginLeftAuto: {\n        marginLeft: 'auto'\n    }\n  }),\n);\n\nexport const Headline: React.FC<Props> = ({ title, value, tooltip, color }) => {\n    const classes = useStyles();\n\n    return <Paper className={classes.root} elevation={3}>\n        <Tooltip title={tooltip}>\n            <Grid container direction=\"column\" alignItems=\"flex-start\" spacing={3}>\n                <Grid item>\n                    <Typography variant=\"body2\">{title}</Typography>\n                </Grid>\n                <Grid item>\n                    <Typography color={color} variant=\"h5\">{value}</Typography>\n                </Grid>\n            </Grid>\n        </Tooltip>\n    </Paper>\n}","import React from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport IconButton from '@material-ui/core/IconButton';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport GitHubIcon from '@material-ui/icons/GitHub';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport qs from 'query-string';\nimport './App.css';\n\nimport {Simulator} from './components/simulator/simulator';\nimport { Container } from '@material-ui/core';\nimport {useInitCovidData} from \"./data-store\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      flexGrow: 1,\n    },\n    menuButton: {\n      marginRight: theme.spacing(2),\n    },\n    title: {\n      flexGrow: 1,\n    },\n    container: {\n      paddingTop: theme.spacing(2)\n    }\n  }),\n);\nconst urlParams = qs.parse(window.location.search);\n\nfunction App() {\n  const classes = useStyles();\n  const covidDataLoaded = useInitCovidData();\n  const isEmbed = !!urlParams.embed;\n\n  return (\n    <div className=\"App\">\n      {!isEmbed && <AppBar position=\"static\">\n        <Toolbar>\n          <IconButton edge=\"start\" className={classes.menuButton} color=\"inherit\" aria-label=\"menu\">\n            <MenuIcon />\n          </IconButton>\n          <Typography variant=\"h6\" className={classes.title}>\n            COVID Simulator\n          </Typography>\n          <Tooltip title=\"Source code\">\n            <IconButton edge=\"end\" className={classes.menuButton} \n              onClick={()=> window.open(\"https://github.com/thoughtspot/sars-cov2-simulator\", \"_blank\")}\n              color=\"inherit\" aria-label=\"code\">\n              <GitHubIcon />\n            </IconButton>\n          </Tooltip>\n          \n        </Toolbar>\n      </AppBar>}\n      <Container maxWidth='lg' className={classes.container}>\n          {(covidDataLoaded) ? <Simulator /> : <div>Loading ...</div>}\n      </Container>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.        xssadsaasdasdasdasdasdasdasdasdasd\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}